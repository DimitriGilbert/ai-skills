# AGENTS.md Anti-Patterns

This guide covers common anti-patterns to avoid when creating or maintaining AGENTS.md files.

## The "Kitchen Sink" Anti-Pattern

### Description
Putting everything in the root AGENTS.md file - git workflow, code style, testing conventions, deployment instructions, etc.

### Why It's Bad
- File becomes unmanageable (200+ lines)
- Agent gets confused by too much information
- Most instructions are irrelevant to any given task
- Token waste on every request

### Example
```markdown
❌ BAD: 150+ lines covering everything

# AGENTS.md

## Git Workflow (30 lines)
## Code Style (40 lines)
## Testing (30 lines)
## API Design (20 lines)
## Deployment (15 lines)
## Security (10 lines)
## ... and more
```

### Solution
Use progressive disclosure. Keep root minimal, move domain-specific rules to separate files.

```markdown
✅ GOOD: 15 lines, links to separate files

# AGENTS.md

This is a React component library for accessible data visualization.

## Package Manager

This project uses pnpm.

## Conventions

- For Git workflow, see [docs/GIT.md](docs/GIT.md)
- For code style, see [docs/STYLE.md](docs/STYLE.md)
- For testing, see [docs/TESTING.md](docs/TESTING.md)
```

## The "Tour Guide" Anti-Pattern

### Description
Extensively documenting file structure with specific paths.

### Why It's Bad
- File paths change constantly
- Documentation goes stale quickly
- Agent confidently looks in wrong places
- High maintenance burden

### Example
```markdown
❌ BAD

## File Structure

```
src/
├── components/
│   ├── Button/
│   │   ├── Button.tsx        # Main component
│   │   ├── Button.test.tsx   # Tests
│   │   └── Button.styles.ts  # Styles
│   └── Input/
│       └── ...
├── hooks/
│   ├── useAuth.ts            # Auth hook
│   └── useData.ts            # Data fetching hook
└── utils/
    └── helpers.ts            # Utility functions
```
```

### Solution
Describe capabilities, not structure. Use patterns to help agent discover files.

```markdown
✅ GOOD

## Architecture

- Components are co-located with their tests and styles
- Look for custom hooks in **/hooks/**/*.ts
- Utility functions in **/utils/**/*.ts
- Use glob patterns when searching for implementations
```

## The "Rule Book" Anti-Pattern

### Description
Using rigid, authoritarian language ("ALWAYS", "MUST", "NEVER").

### Why It's Bad
- Creates confrontational tone
- Often has exceptions that aren't documented
- Agent may follow rules literally even when inappropriate
- Makes file feel oppressive to maintain

### Example
```markdown
❌ BAD

## Code Style

- ALWAYS use const instead of let
- NEVER use any type
- MUST write tests for everything
- ALWAYS use functional components
- NEVER use class components
```

### Solution
Use conversational, pragmatic tone. Acknowledge context matters.

```markdown
✅ GOOD

## Code Style

- Prefer const over let
- Avoid any when possible, use unknown instead
- Write tests for non-trivial code
- Default to functional components
- Use classes only when necessary (e.g., complex state machines)
```

## The "Time Capsule" Anti-Pattern

### Description
Documenting specific implementation details that will go stale.

### Why It's Bad
- Documentation rots quickly
- Agent acts on outdated information
- Hard to maintain when code changes
- Creates false confidence

### Example
```markdown
❌ BAD

## Authentication

Authentication is handled by the AuthService class in src/auth/AuthService.ts.
It uses JWT tokens stored in localStorage under the key 'auth_token'.
Tokens are refreshed every 5 minutes by the tokenRefreshInterval in src/utils/timers.ts.
```

### Solution
Describe stable concepts and patterns, not specific implementations.

```markdown
✅ GOOD

## Authentication

Authentication uses JWT tokens with refresh token rotation.
Look for auth-related modules in **/auth/**/*.ts.
Token management is handled automatically by the auth context.
```

## The "Auto-Generated" Anti-Pattern

### Description
Using initialization scripts to auto-generate AGENTS.md files.

### Why It's Bad
- Prioritizes comprehensiveness over restraint
- Adds "useful for most scenarios" content that isn't relevant
- Creates bloated files from day one
- Violates progressive disclosure principles

### Example
```markdown
❌ BAD: Generated by CLI tool

# AGENTS.md

## Project Overview
## Getting Started
## Available Scripts
## Technology Stack
## Folder Structure
## Coding Standards
## Testing Guidelines
## Git Workflow
## Deployment Process
## Troubleshooting
## Contributing
## License
## Contact
## FAQ
## ... (100+ lines)
```

### Solution
Start minimal. Add only what's essential. Let the file grow organically based on actual needs.

```markdown
✅ GOOD: Hand-crafted, minimal

# AGENTS.md

This is a [one-sentence description].

## Package Manager

This project uses pnpm.

## Commands

- Build: `pnpm build`
- Test: `pnpm test`
```

## The "Obvious Advice" Anti-Pattern

### Description
Including advice that's either obvious to developers or already known by AI agents.

### Why It's Bad
- Wastes tokens
- Clutters the file
- Reduces signal-to-noise ratio
- Makes file longer than necessary

### Examples
```markdown
❌ BAD: Obvious to humans

- Write clean, readable code
- Follow best practices
- Use meaningful variable names
- Don't repeat yourself (DRY)
- Keep functions small and focused
```

```markdown
❌ BAD: Already known by agents

- Use import to import modules
- Use export to export functions
- Use console.log for debugging
- Use async/await for promises
```

### Solution
Remove entirely. The agent already knows this, and human developers don't need it in AGENTS.md.

## The "Contradiction" Anti-Pattern

### Description
Having conflicting instructions, often from multiple contributors over time.

### Why It's Bad
- Agent doesn't know which rule to follow
- Creates unpredictable behavior
- Indicates lack of consensus
- Reduces trust in the file

### Example
```markdown
❌ BAD

Line 15: "Always use functional patterns"
Line 42: "Use classes for React components"

Line 20: "Throw errors for invalid input"
Line 55: "Return null for not-found cases"

Line 30: "Test everything"
Line 60: "Don't test trivial getters"
```

### Solution
Review for contradictions and resolve them. Ask stakeholders which approach to prefer.

```markdown
✅ GOOD: Consistent approach

"Prefer functional patterns in most cases. Use classes only for complex state management."

"Throw errors for invalid input. Return null only for expected not-found cases."

"Write tests for non-trivial code. Skip tests for simple getters/setters."
```

## The "Ball of Mud" Anti-Pattern

### Description
File that grew organically through reactive additions without organization.

### How It Happens
1. Agent does something you don't like
2. You add a rule to prevent it
3. Repeat hundreds of times over months
4. File becomes unmaintainable mess

### Why It's Bad
- No clear organization
- Impossible to find relevant instructions
- Full of edge cases and one-off rules
- Maintenance nightmare

### Solution
Refactor using the process in [REFACTORING.md](REFACTORING.md).

1. Find contradictions
2. Extract essentials
3. Group by domain
4. Create separate files
5. Keep root minimal

## The "Mixed Conventions" Anti-Pattern

### Description
File contains guidance that belongs in other documentation files.

### Why It's Bad
- Clutters AGENTS.md with irrelevant content
- Makes the file harder to use
- Duplicates information better suited elsewhere

### Examples
```markdown
❌ BAD: Git workflow in AGENTS.md

## Git Workflow

- Use conventional commits
- Never commit directly to main
- Write descriptive commit messages
- PR titles should follow format: [type] description
```

```markdown
❌ BAD: Security guidelines in AGENTS.md

## Security

- Never commit secrets
- Use environment variables for config
- Validate all user input
- Sanitize data before display
```

### Solution
Move to appropriate documentation files. AGENTS.md should link to them, not contain them.

```markdown
✅ GOOD: AGENTS.md links to separate files

## Conventions

- For Git workflow, see [CONTRIBUTING.md](CONTRIBUTING.md)
- For security guidelines, see [docs/SECURITY.md](docs/SECURITY.md)
- For code review criteria, see [docs/REVIEW.md](docs/REVIEW.md)
```

## The "Monorepo Overload" Anti-Pattern

### Description
In monorepos, putting everything in the root AGENTS.md.

### Why It's Bad
- Root file becomes massive
- Package-specific guidance gets lost
- Agent sees irrelevant instructions
- Violates scope boundaries

### Example
```markdown
❌ BAD: Root AGENTS.md with everything

# AGENTS.md

## Monorepo Overview
## Frontend Conventions (30 lines)
## Backend Conventions (30 lines)
## Shared Package Conventions (20 lines)
## API Design (20 lines)
## Component Patterns (20 lines)
## ... (150+ lines)
```

### Solution
Use nested AGENTS.md files. Keep root focused on monorepo-level concerns.

```markdown
✅ GOOD: Root is minimal, packages have their own

# Root AGENTS.md (15 lines)
This is a full-stack monorepo with Next.js frontend and Node.js API.

## Commands
- Dev: `pnpm dev`
- Build: `pnpm build`

See each package's AGENTS.md for specific guidelines.

# apps/web/AGENTS.md (20 lines)
Frontend-specific conventions...

# apps/api/AGENTS.md (20 lines)
Backend-specific conventions...
```

## Anti-Pattern Detection Checklist

Use this checklist to detect anti-patterns in your AGENTS.md:

- [ ] File is longer than 75 lines (kitchen sink?)
- [ ] Contains extensive file structure documentation (tour guide?)
- [ ] Uses "ALWAYS", "MUST", "NEVER" throughout (rule book?)
- [ ] Documents specific file paths or modules (time capsule?)
- [ ] Was auto-generated by initialization script (auto-generated?)
- [ ] Contains obvious advice like "write clean code" (obvious advice?)
- [ ] Has conflicting instructions (contradiction?)
- [ ] Grew organically without organization (ball of mud?)
- [ ] Contains Git workflow or security guidelines (mixed conventions?)
- [ ] In monorepo, root contains package-specific details (monorepo overload?)

If you checked any boxes, see the corresponding section above for solutions.

## Recovery Guide

If your AGENTS.md has fallen into anti-patterns:

1. **Assess severity**: How many anti-patterns? How bad?
2. **Prioritize**: Fix the most impactful first (usually kitchen sink or ball of mud)
3. **Use the refactoring guide**: Follow [REFACTORING.md](REFACTORING.md)
4. **Verify after changes**: Use [VERIFICATION.md](VERIFICATION.md) to check improvements
5. **Monitor**: Watch for old patterns creeping back in

Remember: AGENTS.md should be living documentation that evolves with your project. Regular reviews prevent anti-patterns from taking hold.
